@using DevExtremeVSTemplateMVC.Models
@model TaskMainSortableViewModel

<link href="~/css/components/TaskListKanban.css" rel="stylesheet" />
<link href="~/css/components/TaskKanbanCard.css" rel="stylesheet" />
<link href="~/css/components/CardMenu.css" rel="stylesheet" />

<script src="~/js/views/kanbanscript.js"></script>

<div class="view-wrapper view-wrapper-task-list list-page">
    @await Html.PartialAsync("../PlanningTasks/_PlanningTasksToolbar")
    <div id='kanban' class='kanban'>
        @(Html.DevExtreme().ScrollView()
            .Direction(ScrollDirection.Both)
            .ShowScrollbar(ShowScrollbarMode.Always)
            .ID("kanban-scroll-view-id")
            .Content(
            @Html.DevExtreme().Sortable()
            .ID("kanban-sortable-id")
            .ItemOrientation(Orientation.Horizontal)
            .Handle(".list-title")
            .MoveItemOnDrop(true)
            .OnReorder("uitgAppContext.KanbanTasksController.onStatusReorder")
            .Content(@<text>
            @for (int i = 0; i < Model.StatusOrder.Count; i++)
            {
                await Html.RenderPartialAsync("../PlanningTasks/Kanban/_TaskList", new TaskListPartialViewModel
                {
                    Status = Model.StatusOrder[i],
                    TaskList = Model.Tasks,
                    StatusIndex = i,
                });
            }
            </text>).ToString()
        )
    )
    </div>
</div>